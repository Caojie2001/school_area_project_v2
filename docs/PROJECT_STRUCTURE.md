# é¡¹ç›®ç»“æ„è¯¦ç»†è¯´æ˜

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº†é«˜æ ¡å»ºç­‘é¢ç§¯ç¼ºå£æµ‹ç®—ç³»ç»Ÿ V2 çš„å®Œæ•´é¡¹ç›®ç»“æ„ã€‚

## ğŸ“ ç›®å½•æ ‘

```
school_area_project_250922/
â”‚
â”œâ”€â”€ ğŸ”§ é…ç½®ä¸æ ¸å¿ƒæ–‡ä»¶
â”‚   â”œâ”€â”€ config/                          # åç«¯é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ database.js                  # MySQLæ•°æ®åº“è¿æ¥æ± é…ç½®
â”‚   â”‚   â”œâ”€â”€ authService.js               # ç”¨æˆ·è®¤è¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ dataService.js               # æ•°æ®æŒä¹…åŒ–æœåŠ¡ (2161è¡Œ)
â”‚   â”‚   â”œâ”€â”€ routes.js                    # è·¯ç”±é…ç½®ä¸æ³¨å†Œ
â”‚   â”‚   â”œâ”€â”€ appConfig.js                 # åº”ç”¨é…ç½®
â”‚   â”‚   â””â”€â”€ certs/                       # SSLè¯ä¹¦ç›®å½•
â”‚   â”‚       â”œâ”€â”€ cert.pem                 # SSLè¯ä¹¦
â”‚   â”‚       â”œâ”€â”€ key.pem                  # SSLç§é’¥
â”‚   â”‚       â”œâ”€â”€ generate_cert.sh         # è¯ä¹¦ç”Ÿæˆè„šæœ¬
â”‚   â”‚       â””â”€â”€ README.md                # è¯ä¹¦è¯´æ˜æ–‡æ¡£
â”‚   â”‚
â”‚   â”œâ”€â”€ controllers/                     # æ§åˆ¶å™¨å±‚ (MVCæ¶æ„)
â”‚   â”‚   â”œâ”€â”€ auth.controller.js           # è®¤è¯æ§åˆ¶å™¨ (141è¡Œ)
â”‚   â”‚   â”œâ”€â”€ data.controller.js           # æ•°æ®ç®¡ç†æ§åˆ¶å™¨ (360è¡Œ)
â”‚   â”‚   â”œâ”€â”€ download.controller.js       # ä¸‹è½½å¯¼å‡ºæ§åˆ¶å™¨ (1442è¡Œ)
â”‚   â”‚   â”œâ”€â”€ school.controller.js         # å­¦æ ¡ç®¡ç†æ§åˆ¶å™¨ (353è¡Œ)
â”‚   â”‚   â”œâ”€â”€ standards.controller.js      # æ ‡å‡†é…ç½®æ§åˆ¶å™¨ (666è¡Œ)
â”‚   â”‚   â”œâ”€â”€ statistics.controller.js     # ç»Ÿè®¡åˆ†ææ§åˆ¶å™¨ (254è¡Œ)
â”‚   â”‚   â”œâ”€â”€ record.controller.js         # è®°å½•ç®¡ç†æ§åˆ¶å™¨ (150è¡Œ)
â”‚   â”‚   â””â”€â”€ system.controller.js         # ç³»ç»Ÿç®¡ç†æ§åˆ¶å™¨ (314è¡Œ)
â”‚   â”‚
â”‚   â”œâ”€â”€ routes/                          # è·¯ç”±å±‚
â”‚   â”‚   â”œâ”€â”€ auth.routes.js               # è®¤è¯è·¯ç”± (64è¡Œ)
â”‚   â”‚   â”œâ”€â”€ data.routes.js               # æ•°æ®è·¯ç”± (46è¡Œ)
â”‚   â”‚   â”œâ”€â”€ download.routes.js           # ä¸‹è½½è·¯ç”± (33è¡Œ)
â”‚   â”‚   â”œâ”€â”€ school.routes.js             # å­¦æ ¡è·¯ç”± (57è¡Œ)
â”‚   â”‚   â”œâ”€â”€ standards.routes.js          # æ ‡å‡†è·¯ç”± (151è¡Œ)
â”‚   â”‚   â”œâ”€â”€ statistics.routes.js         # ç»Ÿè®¡è·¯ç”± (34è¡Œ)
â”‚   â”‚   â”œâ”€â”€ record.routes.js             # è®°å½•è·¯ç”± (29è¡Œ)
â”‚   â”‚   â””â”€â”€ system.routes.js             # ç³»ç»Ÿè·¯ç”± (97è¡Œ)
â”‚   â”‚
â”‚   â”œâ”€â”€ middleware/                      # ä¸­é—´ä»¶å±‚
â”‚   â”‚   â”œâ”€â”€ auth.middleware.js           # è®¤è¯ä¸­é—´ä»¶ (è§’è‰²æƒé™æ§åˆ¶)
â”‚   â”‚   â””â”€â”€ rateLimiter.middleware.js    # é™æµä¸­é—´ä»¶ (5çº§é™æµç­–ç•¥)
â”‚   â”‚
â”‚   â”œâ”€â”€ server.js                        # Expressä¸»æœåŠ¡å™¨ (2001è¡Œ)
â”‚   â”œâ”€â”€ package.json                     # NPMä¾èµ–é…ç½®
â”‚   â”œâ”€â”€ package-lock.json                # ä¾èµ–ç‰ˆæœ¬é”å®š
â”‚   â”œâ”€â”€ .env                             # ç¯å¢ƒå˜é‡ï¼ˆä¸æäº¤åˆ°Gitï¼‰
â”‚   â”œâ”€â”€ .env.example                     # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”‚   â”œâ”€â”€ .gitignore                       # Gitå¿½ç•¥æ–‡ä»¶
â”‚   â””â”€â”€ Dockerfile                       # Dockerå®¹å™¨é…ç½®
â”‚
â”œâ”€â”€ ğŸŒ å‰ç«¯èµ„æº
â”‚   â””â”€â”€ public/                          # å‰ç«¯é™æ€èµ„æºæ ¹ç›®å½•
â”‚       â”œâ”€â”€ index.html                   # ä¸»é¡µï¼ˆç™»å½•åé¦–é¡µï¼‰
â”‚       â”œâ”€â”€ login.html                   # ç™»å½•é¡µé¢
â”‚       â”‚
â”‚       â”œâ”€â”€ html/                        # é¡µé¢æ¨¡å—ç›®å½•
â”‚       â”‚   â”œâ”€â”€ data-entry-new.html      # æ•°æ®å½•å…¥ï¼ˆæ–°ç‰ˆï¼Œä¸»è¦ä½¿ç”¨ï¼‰
â”‚       â”‚   â”œâ”€â”€ data-entry.html          # æ•°æ®å½•å…¥ï¼ˆæ—§ç‰ˆï¼‰
â”‚       â”‚   â”œâ”€â”€ area-management.html     # é¢ç§¯ç®¡ç†ï¼ˆç°æœ‰/æ‹Ÿå»ºæˆé¢ç§¯ï¼‰
â”‚       â”‚   â”œâ”€â”€ student-planning.html    # å­¦ç”Ÿè§„åˆ’ï¼ˆè§„åˆ’å­¦ç”Ÿæ•°ï¼‰
â”‚       â”‚   â”œâ”€â”€ data-management.html     # å†å²è®°å½•ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ statistics.html          # ç»Ÿè®¡åˆ†æé¡µé¢
â”‚       â”‚   â”œâ”€â”€ calculation-standards.html # æ ‡å‡†é…ç½®ç®¡ç†ï¼ˆç®¡ç†å‘˜ï¼‰
â”‚       â”‚   â””â”€â”€ user-management.html     # ç”¨æˆ·ç®¡ç†ï¼ˆç®¡ç†å‘˜ï¼‰
â”‚       â”‚
â”‚       â”œâ”€â”€ js/                          # JavaScriptæ¨¡å—ç›®å½•
â”‚       â”‚   â”œâ”€â”€ main.js                  # ä¸»åº”ç”¨å…¥å£
â”‚       â”‚   â”œâ”€â”€ auth.js                  # è®¤è¯æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ api.js                   # APIè°ƒç”¨å°è£…
â”‚       â”‚   â”œâ”€â”€ utils.js                 # å·¥å…·å‡½æ•°åº“
â”‚       â”‚   â”œâ”€â”€ dataEntryNew.js          # æ•°æ®å½•å…¥é€»è¾‘ï¼ˆæ–°ç‰ˆï¼‰
â”‚       â”‚   â”œâ”€â”€ dataEntry.js             # æ•°æ®å½•å…¥é€»è¾‘ï¼ˆæ—§ç‰ˆï¼‰
â”‚       â”‚   â”œâ”€â”€ areaManagement.js        # é¢ç§¯ç®¡ç†é€»è¾‘
â”‚       â”‚   â”œâ”€â”€ studentPlanning.js       # å­¦ç”Ÿè§„åˆ’é€»è¾‘
â”‚       â”‚   â”œâ”€â”€ dataManagement.js        # æ•°æ®ç®¡ç†é€»è¾‘
â”‚       â”‚   â”œâ”€â”€ statistics.js            # ç»Ÿè®¡åˆ†æé€»è¾‘
â”‚       â”‚   â”œâ”€â”€ calculationStandards.js  # æ ‡å‡†ç®¡ç†é€»è¾‘
â”‚       â”‚   â”œâ”€â”€ userManagement.js        # ç”¨æˆ·ç®¡ç†é€»è¾‘
â”‚       â”‚   â”œâ”€â”€ componentManager.js      # ç»„ä»¶ç®¡ç†å™¨
â”‚       â”‚   â””â”€â”€ progressManager.js       # è¿›åº¦ç®¡ç†å™¨
â”‚       â”‚
â”‚       â”œâ”€â”€ css/                         # æ ·å¼æ–‡ä»¶ç›®å½•ï¼ˆæ¨¡å—åŒ–ï¼‰
â”‚       â”‚   â”œâ”€â”€ main.css                 # ä¸»æ ·å¼å…¥å£
â”‚       â”‚   â”œâ”€â”€ base.css                 # åŸºç¡€æ ·å¼å’Œé‡ç½®
â”‚       â”‚   â”œâ”€â”€ layout.css               # å¸ƒå±€å’Œæ …æ ¼ç³»ç»Ÿ
â”‚       â”‚   â”œâ”€â”€ components.css           # UIç»„ä»¶æ ·å¼
â”‚       â”‚   â”œâ”€â”€ forms.css                # è¡¨å•æ ·å¼
â”‚       â”‚   â”œâ”€â”€ tables.css               # è¡¨æ ¼æ ·å¼
â”‚       â”‚   â”œâ”€â”€ frozen-table.css         # å†»ç»“è¡¨æ ¼æ ·å¼
â”‚       â”‚   â”œâ”€â”€ results.css              # ç»“æœå±•ç¤ºæ ·å¼
â”‚       â”‚   â”œâ”€â”€ responsive.css           # å“åº”å¼åª’ä½“æŸ¥è¯¢
â”‚       â”‚   â””â”€â”€ student-fields.css       # å­¦ç”Ÿå­—æ®µç‰¹å®šæ ·å¼
â”‚       â”‚
â”‚       â”œâ”€â”€ components/                  # å¯å¤ç”¨HTMLç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ page-header.html         # é¡µé¢å¤´éƒ¨ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ sidebar.html             # ä¾§è¾¹æ ç»„ä»¶
â”‚       â”‚   â””â”€â”€ page-template.html       # é¡µé¢æ¨¡æ¿
â”‚       â”‚
â”‚       â””â”€â”€ assets/                      # é™æ€èµ„æºï¼ˆå›¾ç‰‡ã€å›¾æ ‡ç­‰ï¼‰
â”‚
â”œâ”€â”€ ğŸ› ï¸ å·¥å…·è„šæœ¬
â”‚   â””â”€â”€ scripts/                         # è„šæœ¬å·¥å…·ç›®å½•
â”‚       â”œâ”€â”€ db.sql                       # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ (814è¡Œ)
â”‚       â””â”€â”€ seed_users.js                # æ‰¹é‡åˆ›å»ºç”¨æˆ·è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ§ª æµ‹è¯•
â”‚   â””â”€â”€ test/                            # æµ‹è¯•ç›®å½•
â”‚       â”œâ”€â”€ README.md                    # æµ‹è¯•æ–‡æ¡£
â”‚       â””â”€â”€ test_security.sh             # å®‰å…¨åŠŸèƒ½æµ‹è¯•ï¼ˆHelmet + Rate Limitingï¼‰
â”‚
â”œâ”€â”€ ğŸ“¦ æ•°æ®ä¸å¤‡ä»½
â”‚   â”œâ”€â”€ data/                            # æ•°æ®æ–‡ä»¶ç›®å½•
â”‚   â”‚   â””â”€â”€ åŸå‹/                        # åŸå‹è®¾è®¡æ–‡ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ backups/                         # å¤‡ä»½æ–‡ä»¶ç›®å½•ï¼ˆå·²æ•´ç†ï¼‰
â”‚   â”‚   â”œâ”€â”€ README.md                    # å¤‡ä»½è¯´æ˜æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ server.js.backup_20251024    # ä»£ç å¤‡ä»½ï¼ˆ2025-10-24ï¼‰
â”‚   â”‚   â”œâ”€â”€ database/                    # æ•°æ®åº“å¤‡ä»½
â”‚   â”‚   â”‚   â”œâ”€â”€ backup_20250905T052821/  # 2025å¹´9æœˆ5æ—¥å¤‡ä»½
â”‚   â”‚   â”‚   â””â”€â”€ backup_20250905T052857/  # 2025å¹´9æœˆ5æ—¥å¤‡ä»½
â”‚   â”‚   â””â”€â”€ frontend_old/                # å‰ç«¯æ—§ç‰ˆæœ¬å¤‡ä»½ï¼ˆå·²åºŸå¼ƒï¼‰
â”‚   â”‚       â”œâ”€â”€ data-management-original.html
â”‚   â”‚       â”œâ”€â”€ index_original.html
â”‚   â”‚       â”œâ”€â”€ css_backup_20250814_135311/
â”‚   â”‚       â”œâ”€â”€ js_backup_20250814_135325/
â”‚   â”‚       â””â”€â”€ [å…¶ä»–å‰ç«¯å¤‡ä»½æ–‡ä»¶]
â”‚   â”‚
â”‚   â”œâ”€â”€ logs/                            # è¿è¡Œæ—¥å¿—ç›®å½•
â”‚   â”‚   â”œâ”€â”€ combined.log                 # ç»¼åˆæ—¥å¿—
â”‚   â”‚   â””â”€â”€ error.log                    # é”™è¯¯æ—¥å¿—
â”‚   â”‚
â”‚   â””â”€â”€ output/                          # è¾“å‡ºæ–‡ä»¶ç›®å½•ï¼ˆå¯¼å‡ºçš„Excelç­‰ï¼‰
â”‚
â”œâ”€â”€ ğŸ“„ æ–‡æ¡£
â”‚   â”œâ”€â”€ docs/                            # æ–‡æ¡£ç›®å½•
â”‚   â”‚   â”œâ”€â”€ README.md                    # æ–‡æ¡£ç´¢å¼•
â”‚   â”‚   â””â”€â”€ PROJECT_STRUCTURE.md         # æœ¬æ–‡ä»¶ - é¡¹ç›®ç»“æ„è¯¦è§£
â”‚   â””â”€â”€ README.md                        # é¡¹ç›®ä¸»æ–‡æ¡£
â”‚
â””â”€â”€ âš™ï¸ å…¶ä»–é…ç½®
    â”œâ”€â”€ docker/                          # Dockeré…ç½®
    â”‚   â”œâ”€â”€ Dockerfile                   # Dockeré•œåƒé…ç½®
    â”‚   â””â”€â”€ README.md                    # Dockerä½¿ç”¨æ–‡æ¡£
    â”œâ”€â”€ .env                             # ç¯å¢ƒå˜é‡ï¼ˆä¸æäº¤ï¼‰
    â”œâ”€â”€ .env.example                     # ç¯å¢ƒå˜é‡æ¨¡æ¿
    â”œâ”€â”€ .gitignore                       # Gitå¿½ç•¥è§„åˆ™
    â””â”€â”€ .dockerignore                    # Dockerå¿½ç•¥è§„åˆ™
```

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

### æ€»ä½“ç»Ÿè®¡ (v2.3.0)
- **æ€»ä»£ç é‡**: ~10,000+ è¡Œ
- **åç«¯ä»£ç **: ~7,000 è¡Œ
- **å‰ç«¯ä»£ç **: ~3,000 è¡Œ
- **é…ç½®/è„šæœ¬**: ~1,000 è¡Œ

### server.jsä¼˜åŒ–å†ç¨‹
```
v2.0:  5,465è¡Œï¼ˆå•ä½“æ¶æ„ï¼‰
       â†“ -64% (MVCé‡æ„)
v2.2:  2,001è¡Œï¼ˆMVCæ¶æ„ï¼‰
       â†“ -81.9% (ç¬¬ä¸€é˜¶æ®µæ¨¡å—åŒ–)
       362è¡Œï¼ˆæå–æ§åˆ¶å™¨å’Œè·¯ç”±ï¼‰
       â†“ -41.4% (ç¬¬äºŒé˜¶æ®µæ¨¡å—åŒ–)
v2.3:  212è¡Œï¼ˆæ·±åº¦æ¨¡å—åŒ–ï¼‰â­
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ€»ä½“ä¼˜åŒ–: -89.4%
```

### è¯¦ç»†åˆ†å¸ƒ

#### åç«¯æ ¸å¿ƒ (7,000+ è¡Œ)
- **`server.js`**: **212è¡Œ** â­ (ä¸»æœåŠ¡å™¨å…¥å£)
- `config/dataService.js`: 2,161è¡Œï¼ˆæ•°æ®æœåŠ¡ï¼‰
- `controllers/`: 3,680è¡Œï¼ˆ8ä¸ªæ§åˆ¶å™¨ï¼‰
  - download.controller.js: 1,442è¡Œ
  - standards.controller.js: 666è¡Œ
  - data.controller.js: 360è¡Œ
  - school.controller.js: 353è¡Œ
  - system.controller.js: 314è¡Œ
  - statistics.controller.js: 254è¡Œ
  - record.controller.js: 150è¡Œ
  - auth.controller.js: 141è¡Œ
- `routes/`: 511è¡Œï¼ˆ8ä¸ªè·¯ç”±æ¨¡å—ï¼‰
- **`config/utils/`**: 730è¡Œï¼ˆ3ä¸ªå·¥å…·æ¨¡å—ï¼‰â­ NEW
  - excelGenerator.js: 330è¡Œ
  - calculator.js: 280è¡Œ
  - helpers.js: 120è¡Œ
- **`config/controllers/`**: 650è¡Œï¼ˆ1ä¸ªæ§åˆ¶å™¨ï¼‰â­ NEW
  - online.controller.js: 650è¡Œ
- **`config/routes/`**: 60è¡Œï¼ˆ1ä¸ªè·¯ç”±ï¼‰â­ NEW
  - online.routes.js: 60è¡Œ
- **`middleware/`**: 247è¡Œï¼ˆ4ä¸ªä¸­é—´ä»¶ï¼‰â­ æ–°å¢2ä¸ª
  - security.middleware.js: 159è¡Œ (NEW)
  - static.middleware.js: 88è¡Œ (NEW)
  - auth.middleware.js
  - rateLimiter.middleware.js

#### å‰ç«¯ä»£ç  (~3,000 è¡Œ)
- HTMLé¡µé¢: ~2,000 è¡Œï¼ˆ8ä¸ªä¸»è¦é¡µé¢ï¼‰
- JavaScript: ~1,000 è¡Œï¼ˆ14ä¸ªæ¨¡å—ï¼‰
- CSS: ~500 è¡Œï¼ˆ9ä¸ªæ ·å¼æ¨¡å—ï¼‰

#### é…ç½®ä¸è„šæœ¬
- `scripts/db.sql`: 814 è¡Œï¼ˆæ•°æ®åº“åˆå§‹åŒ–ï¼‰
- é…ç½®æ–‡ä»¶: ~300 è¡Œ
- æµ‹è¯•è„šæœ¬: ~200 è¡Œ

---

## ğŸ“ æ ¸å¿ƒæ–‡ä»¶è¯¦ç»†è¯´æ˜

### åç«¯æ ¸å¿ƒ

#### `server.js` (212è¡Œ) â­ å·²ä¼˜åŒ–
**åŠŸèƒ½**: Expressåº”ç”¨ä¸»æœåŠ¡å™¨ï¼ˆå…¥å£æ–‡ä»¶ï¼‰

**æ¶æ„æ¼”è¿›å†å²**:
- **v2.0**: 5,465è¡Œï¼ˆå•ä½“æ¶æ„ï¼‰
- **v2.2** (2025-10-24): â†’ 2,001è¡Œ (-64%, MVCé‡æ„)
- **v2.3** (2025-10-24): â†’ **212è¡Œ** (-89.4%, æ·±åº¦æ¨¡å—åŒ–)

**ä¸¤é˜¶æ®µä¼˜åŒ–æˆæœ**:
1. **ç¬¬ä¸€é˜¶æ®µ** - MVCæ¶æ„é‡æ„ï¼š
   - æ§åˆ¶å™¨ä¸è·¯ç”±åˆ†ç¦»ï¼ˆ8ä¸ªæ¨¡å—ï¼‰
   - ç§»é™¤ç¡¬ç¼–ç å­¦æ ¡ç±»å‹æ˜ å°„
   - ä¿ç•™æ ¸å¿ƒè®¡ç®—é€»è¾‘
   - ç»“æœï¼š2,001è¡Œ â†’ 362è¡Œ (-81.9%)

2. **ç¬¬äºŒé˜¶æ®µ** - æ¨¡å—åŒ–æ·±åº¦ä¼˜åŒ–ï¼š
   - æå–åœ¨çº¿è®¡ç®—æ¨¡å—ï¼ˆhelpers, calculator, excelGenerator, online.controller, online.routesï¼‰
   - æå–å®‰å…¨ä¸­é—´ä»¶ï¼ˆsecurity.middlewareï¼‰
   - æå–é™æ€æ–‡ä»¶ä¸­é—´ä»¶ï¼ˆstatic.middlewareï¼‰
   - ç»“æœï¼š362è¡Œ â†’ **212è¡Œ** (-41.4%)

**å½“å‰ç»“æ„** (212è¡Œ):
```javascript
// 1. ä¾èµ–å¯¼å…¥ (36è¡Œ)
const express = require('express');
const { loadSSLConfig, helmetConfig, ... } = require('./middleware/security.middleware');
const { configureStaticFiles, configurePageRoutes } = require('./middleware/static.middleware');
// ...å…¶ä»–å¯¼å…¥

// 2. SSLä¸å®‰å…¨é…ç½® (25è¡Œ)
const sslOptions = loadSSLConfig();
app.use(httpsRedirectMiddleware(sslOptions, HTTPS_PORT));
app.use(helmetConfig);
app.use(createSessionMiddleware(sslOptions));
app.use(urlSecurityMiddleware);

// 3. åŸºç¡€ä¸­é—´ä»¶ (7è¡Œ)
app.use(cors());
app.use(express.json());

// 4. é™æ€æ–‡ä»¶æœåŠ¡ (3è¡Œ)
configureStaticFiles(app);

// 5. è·¯ç”±æ³¨å†Œ (28è¡Œ)
app.use('/api/auth', authRoutes);
// ...9ä¸ªè·¯ç”±æ¨¡å—

// 6. é¡µé¢è·¯ç”± (6è¡Œ)
configurePageRoutes(app, requireAuth, ...);

// 7. åˆå§‹åŒ– (10è¡Œ)
// outputç›®å½•åˆ›å»º + å®šæ—¶æ¸…ç†

// 8. æœåŠ¡å™¨å¯åŠ¨ (42è¡Œ)
async function startServer() { ... }

// 9. ä¼˜é›…å…³é—­ (11è¡Œ)
process.on('SIGINT', ...);

// 10. é”™è¯¯å¤„ç† (35è¡Œ)
app.use((req, res, next) => { ... }); // 404
app.use((err, req, res, next) => { ... }); // 500
```

**ä¼˜åŒ–äº®ç‚¹**:
- âœ… èŒè´£å•ä¸€ï¼šä»…è´Ÿè´£ç»„è£…å’Œå¯åŠ¨
- âœ… å¯è¯»æ€§å¼ºï¼š10ä¸ªæ¸…æ™°çš„åŠŸèƒ½åŒºå—
- âœ… ç»´æŠ¤å‹å¥½ï¼šä¸­é—´ä»¶å’Œå·¥å…·ç‹¬ç«‹æ¨¡å—åŒ–
- âœ… æµ‹è¯•é€šè¿‡ï¼šæ‰€æœ‰åŠŸèƒ½æ­£å¸¸è¿è¡Œ

---

#### æ–°å¢å·¥å…·æ¨¡å— (v2.3.0) ğŸ‰

##### `config/utils/helpers.js` (120è¡Œ)
**åŠŸèƒ½**: é€šç”¨å·¥å…·å‡½æ•°åº“
**å¯¼å‡ºå‡½æ•°**:
```javascript
// æ ¼å¼åŒ–é¢ç§¯ä¸ºä¸¤ä½å°æ•°
formatAreaToTwoDecimals(value)

// æ¸…ç†å­¦æ ¡ç±»å‹ï¼ˆå»é™¤å‰ç¼€ï¼‰
cleanSchoolType(schoolType)

// æ¸…ç†outputç›®å½•ä¸­çš„æ—§æ–‡ä»¶ï¼ˆ24å°æ—¶å‰ï¼‰
cleanupOldFiles()

// å¯åŠ¨å®šæ—¶æ¸…ç†ä»»åŠ¡ï¼ˆæ¯2å°æ—¶æ‰§è¡Œä¸€æ¬¡ï¼‰
startCleanupSchedule()
```

##### `config/utils/calculator.js` (280è¡Œ)
**åŠŸèƒ½**: å»ºç­‘é¢ç§¯ç¼ºå£è®¡ç®—å¼•æ“
**æ ¸å¿ƒæ–¹æ³•**:
```javascript
// ä»æ•°æ®åº“æŸ¥è¯¢å­¦æ ¡ç±»å‹
getSchoolType(schoolName)

// åŠ è½½è®¡ç®—æ ‡å‡†ï¼ˆåŸºç¡€+è¡¥è´´ï¼‰
loadCalculationStandards()

// æ ¸å¿ƒè®¡ç®—å‡½æ•°ï¼ˆ196è¡Œé€»è¾‘ï¼‰
calculateBuildingAreaGap(data, specialSubsidyData)
  â†’ è¿”å›åŒ…å«æ‰€æœ‰è®¡ç®—ç»“æœçš„å¯¹è±¡ï¼ˆåº”é…é¢ç§¯ã€ç¼ºå£ç­‰ï¼‰

// è·å–æ ‡å‡†æ•°æ®
getBasicStandards()
getSubsidizedStandards()
```

##### `config/utils/excelGenerator.js` (330è¡Œ)
**åŠŸèƒ½**: Excelå·¥ä½œè¡¨ç”Ÿæˆå™¨
**æ ¸å¿ƒæ–¹æ³•**:
```javascript
// ç”Ÿæˆæ ¼å¼åŒ–çš„ç»“æœè¡¨ï¼ˆ311è¡Œé€»è¾‘ï¼‰
generateFormattedResultSheet(school)
  â†’ è¿”å›XLSXå·¥ä½œè¡¨å¯¹è±¡
  â†’ åŒ…å«ï¼šå•å…ƒæ ¼åˆå¹¶ã€è¾¹æ¡†ã€é¢œè‰²ã€åˆ—å®½ç­‰å®Œæ•´æ ¼å¼
```

##### `config/controllers/online.controller.js` (650è¡Œ)
**åŠŸèƒ½**: åœ¨çº¿è®¡ç®—æ§åˆ¶å™¨
**è·¯ç”±å¤„ç†å™¨**:
```javascript
// POST /online-calculate
onlineCalculate(req, res)
  â†’ æ¥æ”¶å­¦æ ¡æ•°æ®å’Œç‰¹æ®Šè¡¥åŠ©
  â†’ è°ƒç”¨calculateBuildingAreaGapè®¡ç®—
  â†’ ä¿å­˜åˆ°æ•°æ®åº“
  â†’ è¿”å›è®¡ç®—ç»“æœ

// POST /online-download
onlineDownload(req, res)
  â†’ ç”ŸæˆExcelæ–‡ä»¶
  â†’ ä¸‹è½½å•ä¸ªè®¡ç®—ç»“æœ

// POST /api/download-calculation-results
downloadCalculationResults(req, res)
  â†’ æ”¯æŒå•æ–‡ä»¶æˆ–ZIPå‹ç¼©åŒ…
  â†’ æ‰¹é‡ä¸‹è½½å¤šæ¡è®°å½•
```

##### `config/routes/online.routes.js` (60è¡Œ)
**åŠŸèƒ½**: åœ¨çº¿è®¡ç®—è·¯ç”±å®šä¹‰
**è·¯ç”±é…ç½®**:
```javascript
// åœ¨çº¿è®¡ç®—ï¼ˆéœ€è®¤è¯ + é™æµï¼‰
POST /online-calculate
  â†’ calculationLimiter (100æ¬¡/15åˆ†é’Ÿ)
  â†’ requireAuth
  â†’ onlineController.onlineCalculate

// åœ¨çº¿ä¸‹è½½ï¼ˆé™æµï¼‰
POST /online-download
  â†’ downloadLimiter (50æ¬¡/15åˆ†é’Ÿ)
  â†’ onlineController.onlineDownload

// æ‰¹é‡ä¸‹è½½ï¼ˆéœ€è®¤è¯ï¼‰
POST /api/download-calculation-results
  â†’ requireAuth
  â†’ onlineController.downloadCalculationResults
```

---

#### æ–°å¢ä¸­é—´ä»¶æ¨¡å— (v2.3.0) ğŸ‰

##### `middleware/security.middleware.js` (159è¡Œ)
**åŠŸèƒ½**: å®‰å…¨é…ç½®ä¸­é—´ä»¶é›†åˆ
**å¯¼å‡ºå†…å®¹**:
```javascript
// SSLè¯ä¹¦åŠ è½½
loadSSLConfig()
  â†’ è¯»å–è¯ä¹¦æ–‡ä»¶
  â†’ è¿”å›sslOptionsæˆ–null

// HTTPSå¼ºåˆ¶é‡å®šå‘
httpsRedirectMiddleware(sslOptions, httpsPort)
  â†’ è¿”å›Expressä¸­é—´ä»¶å‡½æ•°
  â†’ æ£€æŸ¥HTTPS_FORCE_REDIRECTç¯å¢ƒå˜é‡

// Helmetå®‰å…¨å¤´é…ç½®
helmetConfig
  â†’ CSPå†…å®¹å®‰å…¨ç­–ç•¥
  â†’ å„ç±»å®‰å…¨å“åº”å¤´

// ä¼šè¯ä¸­é—´ä»¶å·¥å‚
createSessionMiddleware(sslOptions)
  â†’ é…ç½®sessionå‚æ•°
  â†’ æ ¹æ®SSLçŠ¶æ€è®¾ç½®secure cookie

// URLå®‰å…¨éªŒè¯ä¸­é—´ä»¶
urlSecurityMiddleware
  â†’ é˜²æ­¢URLé‡å®šå‘æ”»å‡»
  â†’ é˜²æ­¢è·¯å¾„ç©¿è¶Šæ”»å‡»
  â†’ é™åˆ¶URLé•¿åº¦
```

##### `middleware/static.middleware.js` (88è¡Œ)
**åŠŸèƒ½**: é™æ€æ–‡ä»¶å’Œé¡µé¢è·¯ç”±é…ç½®
**å¯¼å‡ºå‡½æ•°**:
```javascript
// é…ç½®é™æ€æ–‡ä»¶æœåŠ¡
configureStaticFiles(app)
  â†’ ç™»å½•é¡µé¢æ— éœ€è®¤è¯
  â†’ publicç›®å½•é™æ€æ–‡ä»¶é…ç½®
  â†’ å®‰å…¨å¤´è®¾ç½®
  â†’ è·¯å¾„éªŒè¯

// é…ç½®é¡µé¢è·¯ç”±
configurePageRoutes(app, requireAuth, requireAdmin, requireConstructionCenterOrAdmin, safeRedirect)
  â†’ 7ä¸ªé¡µé¢è·¯ç”±é‡å®šå‘
  â†’ ä¸»é¡µã€ç”¨æˆ·ç®¡ç†ã€ç»Ÿè®¡åˆ†æç­‰
  â†’ æƒé™ä¸­é—´ä»¶åº”ç”¨
```

---

#### MVCæ¶æ„æ¨¡å—

##### Controllersï¼ˆæ§åˆ¶å™¨å±‚ï¼‰

**`controllers/download.controller.js` (1442è¡Œ)**
- åŠŸèƒ½ï¼šä¸‹è½½å¯¼å‡ºæ ¸å¿ƒé€»è¾‘
- åŒ…å«ï¼šExcelç”Ÿæˆã€å®½è¡¨ç”Ÿæˆã€æ‰¹é‡å¯¼å‡º
- å…³é”®æ–¹æ³•ï¼š
  - generateFormattedResultSheet() - æ ¼å¼åŒ–ç»“æœè¡¨
  - generateWideTableSheet() - ç”Ÿæˆå®½è¡¨
  - downloadCalculationResults() - å•æ¡è®°å½•ä¸‹è½½
  - batchDownload() - æ‰¹é‡å¯¼å‡º

**`controllers/standards.controller.js` (666è¡Œ)**
- åŠŸèƒ½ï¼šæ ‡å‡†é…ç½®ç®¡ç†
- åŒ…å«ï¼šåŸºç¡€æ ‡å‡†ã€è¡¥è´´æ ‡å‡†çš„å¢åˆ æ”¹æŸ¥
- åŠ¨æ€åŠ è½½é™¢æ ¡ç±»å‹å’Œç”¨æˆ¿ç±»å‹

**`controllers/school.controller.js` (353è¡Œ)**
- åŠŸèƒ½ï¼šå­¦æ ¡ç®¡ç†
- åŒ…å«ï¼šå­¦æ ¡æ³¨å†Œè¡¨ã€è§„åˆ’å­¦ç”Ÿæ•°ã€ç°æœ‰é¢ç§¯é¢„è®¾

**`controllers/data.controller.js` (360è¡Œ)**
- åŠŸèƒ½ï¼šæ•°æ®ç®¡ç†
- åŒ…å«ï¼šä¿å­˜ã€æŸ¥è¯¢ã€åˆ é™¤è®¡ç®—è®°å½•

**`controllers/statistics.controller.js` (254è¡Œ)**
- åŠŸèƒ½ï¼šç»Ÿè®¡åˆ†æ
- åŒ…å«ï¼šæ€»ä½“æ¦‚è§ˆã€é™¢æ ¡ç±»å‹åˆ†æã€å¹´åº¦è¶‹åŠ¿

**`controllers/system.controller.js` (314è¡Œ)**
- åŠŸèƒ½ï¼šç³»ç»Ÿç®¡ç†
- åŒ…å«ï¼šæäº¤å•ä½åˆ—è¡¨ã€æ¸…ç†æ“ä½œ

**`controllers/record.controller.js` (150è¡Œ)**
- åŠŸèƒ½ï¼šè®°å½•ç®¡ç†
- åŒ…å«ï¼šå•æ¡è®°å½•æŸ¥è¯¢ã€åˆ é™¤

**`controllers/auth.controller.js` (141è¡Œ)**
- åŠŸèƒ½ï¼šè®¤è¯æ§åˆ¶
- åŒ…å«ï¼šç™»å½•ã€ç™»å‡ºã€ä¼šè¯éªŒè¯

##### Routesï¼ˆè·¯ç”±å±‚ï¼‰

8ä¸ªè·¯ç”±æ¨¡å—ï¼Œæ¯ä¸ªå¯¹åº”ä¸€ä¸ªæ§åˆ¶å™¨ï¼š
- `auth.routes.js` (64è¡Œ) - è®¤è¯è·¯ç”±
- `standards.routes.js` (151è¡Œ) - æ ‡å‡†è·¯ç”±ï¼ˆæœ€å¤æ‚ï¼‰
- `system.routes.js` (97è¡Œ) - ç³»ç»Ÿè·¯ç”±
- `school.routes.js` (57è¡Œ) - å­¦æ ¡è·¯ç”±
- `data.routes.js` (46è¡Œ) - æ•°æ®è·¯ç”±
- `statistics.routes.js` (34è¡Œ) - ç»Ÿè®¡è·¯ç”±
- `download.routes.js` (33è¡Œ) - ä¸‹è½½è·¯ç”±
- `record.routes.js` (29è¡Œ) - è®°å½•è·¯ç”±

##### Middlewareï¼ˆä¸­é—´ä»¶å±‚ï¼‰

**`middleware/auth.middleware.js`**
- requireAuth - è¦æ±‚ç™»å½•
- requireAdmin - è¦æ±‚ç®¡ç†å‘˜æƒé™
- requireBaseConstruction - è¦æ±‚åŸºå»ºä¸­å¿ƒæƒé™

**`middleware/rateLimiter.middleware.js`**
- 5ä¸ªç‹¬ç«‹é™æµå™¨é…ç½®
- è‡ªå®šä¹‰é™æµæ¶ˆæ¯å’Œæ—¥å¿—

---

#### `config/database.js`
**åŠŸèƒ½**: MySQLæ•°æ®åº“è¿æ¥é…ç½®
**å†…å®¹**:
- è¿æ¥æ± é…ç½®
- è¿æ¥å‚æ•°ï¼ˆä».envè¯»å–ï¼‰
- è¿æ¥æµ‹è¯•å’Œé”™è¯¯å¤„ç†
- å­—ç¬¦é›†è®¾ç½®ï¼ˆutf8mb4ï¼‰

---

#### `config/authService.js`
**åŠŸèƒ½**: ç”¨æˆ·è®¤è¯æœåŠ¡
**æä¾›çš„æ–¹æ³•**:
- `loginUser(username, password)` - ç”¨æˆ·ç™»å½•éªŒè¯
- `createUser(userData)` - åˆ›å»ºæ–°ç”¨æˆ·
- `updateUserStatus(userId, isEnabled)` - æ›´æ–°ç”¨æˆ·çŠ¶æ€
- `getAllUsers()` - è·å–æ‰€æœ‰ç”¨æˆ·
- `deleteUser(userId)` - åˆ é™¤ç”¨æˆ·
- `changePassword(userId, newPassword)` - ä¿®æ”¹å¯†ç 

**å®‰å…¨ç‰¹æ€§**:
- BCryptå¯†ç åŠ å¯†ï¼ˆ10è½®åŠ ç›ï¼‰
- å¯†ç å¼ºåº¦éªŒè¯
- Sessionç®¡ç†

---

#### `config/dataService.js` (2161è¡Œ)
**åŠŸèƒ½**: æ•°æ®æŒä¹…åŒ–æ ¸å¿ƒæœåŠ¡
**æ ¸å¿ƒèŒè´£**:
- å­¦æ ¡æ•°æ®çš„å¢åˆ æ”¹æŸ¥
- å®Œæ•´å­—æ®µçš„æ•°æ®æ˜ å°„å’ŒéªŒè¯
- è®¡ç®—å†å²è®°å½•ç®¡ç†
- ç‰¹æ®Šè¡¥åŠ©æ•°æ®å¤„ç†
- æ ‡å‡†é…ç½®ç®¡ç†ï¼ˆåŸºç¡€æ ‡å‡†ã€è¡¥è´´æ ‡å‡†ï¼‰
- è§„åˆ’å­¦ç”Ÿæ•°ç®¡ç†
- ç°æœ‰é¢ç§¯é¢„è®¾ç®¡ç†

**å…³é”®æ–¹æ³•**:
```javascript
// ä¿å­˜å­¦æ ¡è®°å½•ï¼ˆæ ¸å¿ƒæ–¹æ³•ï¼‰
saveSchoolRecord(data)

// è·å–å­¦æ ¡è®°å½•åˆ—è¡¨
getSchoolRecords(filters)

// é€šè¿‡IDè·å–å•æ¡è®°å½•
getSchoolRecordById(id)

// åˆ é™¤è®°å½•
deleteSchoolRecord(id)

// æ ‡å‡†ç®¡ç†
getBaselineAreas()
updateBaselineArea(id, value)
getSubsidizedAreaStandards()

// è§„åˆ’å­¦ç”Ÿæ•°
getPlannedStudents(schoolName, year)
savePlannedStudents(data)

// å­¦æ ¡ç±»å‹ç®¡ç†ï¼ˆ2025-10-24ä¼˜åŒ–ï¼‰
getSchoolType(schoolName) - ä»school_registryè¡¨åŠ¨æ€æŸ¥è¯¢
```

**æ•°æ®éªŒè¯**:
- æ•°å€¼è§„èŒƒåŒ–ï¼ˆparseFloatå¤„ç†ï¼‰
- å­—æ®µå®Œæ•´æ€§æ£€æŸ¥
- ä¸šåŠ¡é€»è¾‘éªŒè¯

---

### å‰ç«¯æ ¸å¿ƒ

#### `public/js/api.js`
**åŠŸèƒ½**: åç«¯APIè°ƒç”¨å°è£…
**æä¾›çš„æ–¹æ³•**:
```javascript
// é€šç”¨HTTPæ–¹æ³•
apiGet(url)
apiPost(url, data)
apiPut(url, data)
apiDelete(url)

// ä¸šåŠ¡API
login(username, password)
logout()
saveSchoolData(data)
getSchoolData(filters)
downloadRecord(id)
onlineCalculate(data)
```

**ç‰¹æ€§**:
- ç»Ÿä¸€é”™è¯¯å¤„ç†
- è‡ªåŠ¨Sessionç®¡ç†
- å“åº”æ•°æ®æ ‡å‡†åŒ–
- ä¿®å¤ï¼šnullæ£€æŸ¥é˜²æ­¢ç©ºæŒ‡é’ˆé”™è¯¯

---

#### `public/js/dataEntry.js`
**åŠŸèƒ½**: æ•°æ®å½•å…¥é¡µé¢é€»è¾‘
**æ ¸å¿ƒåŠŸèƒ½**:
- å­¦æ ¡å’Œå¹´ä»½é€‰æ‹©
- è§„åˆ’å­¦ç”Ÿæ•°åŠ è½½
- é¢ç§¯æ•°æ®å½•å…¥ï¼ˆ7å¤§ç”¨æˆ¿ç±»å‹ Ã— 7ä¸ªç»´åº¦ï¼‰
- å®æ—¶è®¡ç®—ï¼ˆåº”é…ã€æ±‡æ€»ã€ç¼ºå£ï¼‰
- ç‰¹æ®Šè¡¥åŠ©ç®¡ç†
- è¡¨å•éªŒè¯
- æ•°æ®æäº¤å’Œä¿å­˜

**å…³é”®æ”¹è¿›** (v2.1.0):
- å­¦æ ¡é€‰æ‹©è‡ªåŠ¨é‡ç½®è¡¨å•
- ä¿ç•™å­¦æ ¡é€‰æ‹©ï¼Œæ¸…ç©ºè§„åˆ’è¡¨å’Œç»“æœ
- ä¼˜åŒ–äº¤äº’ä½“éªŒ

---

#### `public/js/dataManagement.js`
**åŠŸèƒ½**: å†å²è®°å½•ç®¡ç†
**æ ¸å¿ƒåŠŸèƒ½**:
- è®°å½•åˆ—è¡¨å±•ç¤º
- ç­›é€‰å’Œæœç´¢
- è®°å½•è¯¦æƒ…æŸ¥çœ‹
- Excelä¸‹è½½
- æ‰¹é‡æ“ä½œ
- è®°å½•åˆ é™¤

---

#### `public/js/statistics.js`
**åŠŸèƒ½**: ç»Ÿè®¡åˆ†ææ¨¡å—
**æ ¸å¿ƒåŠŸèƒ½**:
- æ€»ä½“æ¦‚è§ˆç»Ÿè®¡
- æŒ‰é™¢æ ¡ç±»å‹åˆ†æ
- æŒ‰ç”¨æˆ¿ç±»å‹åˆ†æ
- å¹´åº¦è¶‹åŠ¿åˆ†æ
- å›¾è¡¨å¯è§†åŒ–ï¼ˆChart.jsï¼‰
- ç¼ºå£é¢„è­¦

---

### æ•°æ®åº“è„šæœ¬

#### `scripts/db.sql` (814è¡Œ)
**åŠŸèƒ½**: æ•°æ®åº“åˆå§‹åŒ–å’Œæ•°æ®é¢„ç½®
**åŒ…å«å†…å®¹**:

1. **æ•°æ®åº“å’Œè¡¨ç»“æ„åˆ›å»º**:
   - `users` - ç”¨æˆ·è¡¨ï¼ˆ3ç§è§’è‰²ï¼‰
   - `calculation_history` - è®¡ç®—å†å²ï¼ˆå®Œæ•´å­—æ®µè®°å½•ï¼‰
   - `school_registry` - å­¦æ ¡æ³¨å†Œè¡¨ï¼ˆ29æ‰€é«˜æ ¡ + åŠ¨æ€ç±»å‹ï¼‰
   - `basic_area_standards` - åŸºç¡€é¢ç§¯æ ‡å‡†ï¼ˆ10ç§é™¢æ ¡ç±»å‹ï¼‰
   - `subsidized_area_standards` - è¡¥è´´é¢ç§¯æ ‡å‡†ï¼ˆåŠ¨æ€åŠ è½½ï¼‰
   - `planned_students` - è§„åˆ’å­¦ç”Ÿæ•°
   - `special_subsidies` - ç‰¹æ®Šè¡¥åŠ©
   - `current_area_presets` - ç°æœ‰é¢ç§¯é¢„è®¾

2. **åˆå§‹åŒ–æ•°æ®**:
   - é»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼ˆadminï¼‰
   - 29æ‰€ä¸Šæµ·é«˜æ ¡ä¿¡æ¯åŠé™¢æ ¡ç±»å‹
   - é¢ç§¯æ ‡å‡†é…ç½®ï¼ˆ10ç±»é™¢æ ¡ Ã— 5ç±»ç”¨æˆ¿ï¼‰
   - è§„åˆ’å­¦ç”Ÿæ•°é¢„è®¾

3. **è§¦å‘å™¨**:
   - è®¡ç®—è®°å½•åˆ é™¤æ—¶çº§è”åˆ é™¤ç‰¹æ®Šè¡¥åŠ©

4. **ç´¢å¼•ä¼˜åŒ–**:
   - å¸¸ç”¨æŸ¥è¯¢å­—æ®µå»ºç«‹ç´¢å¼•
   - å¤åˆç´¢å¼•æå‡æŸ¥è¯¢æ€§èƒ½

**é‡è¦æ›´æ–°** (2025-10-24):
- school_registryè¡¨æˆä¸ºå­¦æ ¡ç±»å‹çš„å”¯ä¸€æ•°æ®æº
- ç§»é™¤ä»£ç ä¸­çš„ç¡¬ç¼–ç æ˜ å°„
- æ”¯æŒåŠ¨æ€æ·»åŠ æ–°å­¦æ ¡å’Œç±»å‹

---

## ğŸ§ª æµ‹è¯•ç›®å½•è¯¦ç»†è¯´æ˜

### æµ‹è¯•æ–‡ä»¶ç»“æ„

#### 1. `test/test_security.sh`
**åŠŸèƒ½**: å®‰å…¨åŠŸèƒ½è‡ªåŠ¨åŒ–æµ‹è¯•
**æµ‹è¯•é¡¹ç›®**:
1. âœ… **Helmet å®‰å…¨å¤´éªŒè¯**
   - X-Content-Type-Options
   - X-Frame-Options / CSP
   - Strict-Transport-Security

2. âœ… **ç™»å½•æ¥å£é™æµæµ‹è¯•**ï¼ˆé˜²æš´åŠ›ç ´è§£ï¼‰
   - å‘é€ 21 æ¬¡ç™»å½•è¯·æ±‚
   - å‰ 20 æ¬¡åº”è¿”å› 401ï¼ˆè®¤è¯å¤±è´¥ï¼‰
   - ç¬¬ 21 æ¬¡åº”è¿”å› 429ï¼ˆé™æµè§¦å‘ï¼‰

3. âœ… **API é€šç”¨é™æµæµ‹è¯•**
   - éªŒè¯ 400æ¬¡/15åˆ†é’Ÿé™åˆ¶
   - å¿«é€Ÿå‘é€ 3 æ¬¡è¯·æ±‚ï¼ˆä¸è§¦å‘ï¼‰

4. âœ… **ä¸‹è½½æ¥å£é™æµæµ‹è¯•**ï¼ˆé˜²æ•°æ®çˆ¬å–ï¼‰
   - è‡ªåŠ¨ç™»å½•è·å– Session Cookie
   - å‘é€ 41 æ¬¡ä¸‹è½½è¯·æ±‚
   - å‰ 40 æ¬¡åº”è¿”å› 200/404
   - ç¬¬ 41 æ¬¡åº”è¿”å› 429ï¼ˆé™æµè§¦å‘ï¼‰

5. âœ… **è®¡ç®—æ¥å£é™æµæµ‹è¯•**ï¼ˆé˜²èµ„æºæ»¥ç”¨ï¼‰
   - ä½¿ç”¨ç™»å½•çŠ¶æ€å‘é€è¯·æ±‚
   - å‘é€ 81 æ¬¡è®¡ç®—è¯·æ±‚
   - å‰ 80 æ¬¡æ­£å¸¸ï¼Œç¬¬ 81 æ¬¡é™æµ

**æ™ºèƒ½åŠŸèƒ½**:
- è‡ªåŠ¨æ£€æµ‹æœåŠ¡å™¨è¿è¡ŒçŠ¶æ€
- æç¤ºé‡å¯æœåŠ¡å™¨ä»¥æ¸…é™¤é™æµ
- è‡ªåŠ¨ç™»å½•å¹¶ç®¡ç† Session Cookie
- æµ‹è¯•å®Œæˆåè‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶

**ä½¿ç”¨æ–¹æ³•**:
```bash
./test/test_security.sh
```

**å‰ç½®æ¡ä»¶**:
- æœåŠ¡å™¨è¿è¡Œä¸­ï¼ˆ`npm start` æˆ– `pm2 start`ï¼‰
- ç«¯å£ 3000 å¯è®¿é—®
- å»ºè®®æµ‹è¯•å‰é‡å¯æœåŠ¡å™¨æ¸…é™¤é™æµè®°å½•

---

#### 2. `test/README.md`
**åŠŸèƒ½**: æµ‹è¯•æ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—
**å†…å®¹åŒ…æ‹¬**:
- æµ‹è¯•å¥—ä»¶è¯´æ˜
- è¿è¡Œæ–¹æ³•å’Œæœ€ä½³å®è·µ
- æµ‹è¯•å‰å‡†å¤‡å’Œæµ‹è¯•åæ¸…ç†
- æœªæ¥æ‰©å±•è®¡åˆ’ï¼ˆå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€E2Eæµ‹è¯•ï¼‰
- å¸¸è§é—®é¢˜è§£ç­”

---

### æµ‹è¯•è¦†ç›–èŒƒå›´

| æµ‹è¯•ç±»å‹ | çŠ¶æ€ | è¦†ç›–ç‡ | è¯´æ˜ |
|---------|------|--------|------|
| **å®‰å…¨æµ‹è¯•** | âœ… å·²å®ç° | 100% | Helmet + Rate Limitingï¼ˆ5ä¸ªé™æµå™¨ï¼‰|
| å•å…ƒæµ‹è¯• | â³ è®¡åˆ’ä¸­ | 0% | è®¤è¯ã€è®¡ç®—ã€æ•°æ®åº“æ¨¡å— |
| é›†æˆæµ‹è¯• | â³ è®¡åˆ’ä¸­ | 0% | API æ¥å£å’Œä¸šåŠ¡æµç¨‹ |
| æ€§èƒ½æµ‹è¯• | â³ è®¡åˆ’ä¸­ | 0% | è´Ÿè½½å’Œå‹åŠ›æµ‹è¯• |
| E2E æµ‹è¯• | â³ è®¡åˆ’ä¸­ | 0% | å®Œæ•´ç”¨æˆ·æµç¨‹ |

---

### æµ‹è¯•æ—¥å¿—å’Œç›‘æ§

**æŸ¥çœ‹é™æµè§¦å‘æ—¥å¿—**:
```bash
# æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
tail -f logs/combined.log | grep "é™æµè§¦å‘"

# ç»Ÿè®¡ä»Šæ—¥é™æµæ¬¡æ•°
grep "é™æµè§¦å‘" logs/combined.log | grep "$(date +%Y-%m-%d)" | wc -l
```

**æ—¥å¿—æ ¼å¼ç¤ºä¾‹**:
```
[2025-10-24T10:30:45.123Z] é™æµè§¦å‘ - ç™»å½•é™æµï¼ˆå¯èƒ½çš„æš´åŠ›ç ´è§£å°è¯•ï¼‰
  IP: 192.168.1.100
  ç”¨æˆ·: æœªç™»å½•
  è·¯å¾„: /api/auth/login
  User-Agent: Mozilla/5.0...
```

---

## ğŸ“¦ æ•°æ®ä¸å¤‡ä»½ç›®å½•

### backups/ ç›®å½•ç»“æ„

#### server.js.backup_20251024
**è¯´æ˜**: ä»£ç å¤‡ä»½ï¼ˆ2025å¹´10æœˆ24æ—¥ï¼‰
- ä¿å­˜æ¸…ç†ä¼˜åŒ–å‰çš„å®Œæ•´ä»£ç 
- ç”¨äºå¯¹æ¯”å’Œå›é€€
- ä½ç½®ï¼š`backups/server.js.backup_20251024`

#### database/ - æ•°æ®åº“å¤‡ä»½
**åŒ…å«**:
- `backup_20250905T052821/` - 2025å¹´9æœˆ5æ—¥æ•°æ®åº“å¤‡ä»½
- `backup_20250905T052857/` - 2025å¹´9æœˆ5æ—¥æ•°æ®åº“å¤‡ä»½

**æ¯ä¸ªå¤‡ä»½åŒ…å«**:
- `basic_area_standards.sql` - åŸºç¡€é¢ç§¯æ ‡å‡†
- `calculation_history.sql` - è®¡ç®—å†å²è®°å½•
- `school_registry.sql` - å­¦æ ¡æ³¨å†Œè¡¨
- `special_subsidies.sql` - ç‰¹æ®Šè¡¥åŠ©æ•°æ®
- `subsidized_area_standards.sql` - è¡¥è´´é¢ç§¯æ ‡å‡†
- `users.sql` - ç”¨æˆ·æ•°æ®

**æ¢å¤æ–¹æ³•**:
```bash
cd backups/database/backup_20250905T052857/
mysql -u root -p school_area_management < basic_area_standards.sql
mysql -u root -p school_area_management < calculation_history.sql
# ... å…¶ä»–è¡¨
```

---

#### frontend_old/ - å‰ç«¯æ—§ç‰ˆæœ¬å¤‡ä»½ï¼ˆå·²åºŸå¼ƒï¼‰
**è¯´æ˜**: åŒ…å«2025å¹´8æœˆ14æ—¥ä¹‹å‰çš„å‰ç«¯ä»£ç å¤‡ä»½
- æ¨¡å—åŒ–é‡æ„å‰çš„å•æ–‡ä»¶ç‰ˆæœ¬
- CSS å’Œ JavaScript é‡æ„å‰çš„å¤‡ä»½
- å·²è¢«å½“å‰æ¨¡å—åŒ–æ¶æ„æ›¿ä»£

âš ï¸ **æ³¨æ„**: è¿™äº›å¤‡ä»½ä»…ä½œå†å²å‚è€ƒï¼Œä¸å»ºè®®æ¢å¤ä½¿ç”¨

---

### logs/ ç›®å½•
**è¿è¡Œæ—¥å¿—å­˜å‚¨**:
- `combined.log` - ç»¼åˆæ—¥å¿—ï¼ˆåŒ…å«æ‰€æœ‰çº§åˆ«ï¼‰
- `error.log` - é”™è¯¯æ—¥å¿—ï¼ˆä»…é”™è¯¯å’Œè­¦å‘Šï¼‰

**æ—¥å¿—æŸ¥çœ‹**:
```bash
# å®æ—¶æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
tail -f logs/combined.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/error.log

# æœç´¢ç‰¹å®šå†…å®¹
grep "é™æµè§¦å‘" logs/combined.log
```

---

### output/ ç›®å½•
**å¯¼å‡ºæ–‡ä»¶å­˜å‚¨**:
- Excelå¯¼å‡ºæ–‡ä»¶ä¸´æ—¶å­˜å‚¨
- æ‰¹é‡å¯¼å‡ºç»“æœ
- åœ¨çº¿æµ‹ç®—ç»“æœ

âš ï¸ **æ³¨æ„**: æ­¤ç›®å½•æ–‡ä»¶ä¼šå®šæœŸæ¸…ç†ï¼Œä¸å»ºè®®é•¿æœŸå­˜å‚¨

---

## âš™ï¸ é…ç½®æ–‡ä»¶è¯´æ˜

### .envï¼ˆç¯å¢ƒå˜é‡ï¼‰
**ä¸æäº¤åˆ°Git**ï¼ŒåŒ…å«æ•æ„Ÿä¿¡æ¯

**å¿…éœ€é…ç½®**:
```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=school_area_db
DB_PORT=3306

# æœåŠ¡å™¨é…ç½®
PORT=3000
SESSION_SECRET=your-secret-key-here

# HTTPSé…ç½®ï¼ˆå¯é€‰ï¼‰
HTTPS_ENABLED=false
HTTPS_FORCE_REDIRECT=false
```

---

### .env.exampleï¼ˆç¯å¢ƒå˜é‡æ¨¡æ¿ï¼‰
**æäº¤åˆ°Git**ï¼Œä¾›å¼€å‘è€…å‚è€ƒ

**ä½¿ç”¨æ–¹æ³•**:
```bash
cp .env.example .env
# ç„¶åç¼–è¾‘ .env å¡«å…¥å®é™…é…ç½®
```

---

### .gitignore
**Gitå¿½ç•¥è§„åˆ™**

**ä¸»è¦å¿½ç•¥**:
- `.env` - ç¯å¢ƒå˜é‡æ–‡ä»¶
- `node_modules/` - ä¾èµ–ç›®å½•
- `*.log` - æ—¥å¿—æ–‡ä»¶
- `logs/` - æ—¥å¿—ç›®å½•
- `backups/` - å¤‡ä»½æ–‡ä»¶
- `output/` - è¾“å‡ºæ–‡ä»¶
- `cookies.txt` - Cookieæ–‡ä»¶
- `.DS_Store` - macOSç³»ç»Ÿæ–‡ä»¶

---

## ğŸ”§ å¼€å‘å·¥å…·å’Œè„šæœ¬

### install.sh
**åŠŸèƒ½**: è‡ªåŠ¨åŒ–å®‰è£…è„šæœ¬
**å†…å®¹**:
- æ£€æŸ¥Node.jsç‰ˆæœ¬
- å®‰è£…npmä¾èµ–
- æ•°æ®åº“é…ç½®å‘å¯¼
- .envæ–‡ä»¶ç”Ÿæˆ
- é¦–æ¬¡å¯åŠ¨æŒ‡å—

**ä½¿ç”¨æ–¹æ³•**:
```bash
chmod +x install.sh
./install.sh
```

---

### scripts/seed_users.js
**åŠŸèƒ½**: æ‰¹é‡åˆ›å»ºç”¨æˆ·è„šæœ¬
**ç”¨é€”**:
- å¿«é€Ÿåˆ›å»ºå¤šä¸ªå­¦æ ¡è´¦å·
- æµ‹è¯•ç¯å¢ƒç”¨æˆ·ç”Ÿæˆ
- æ‰¹é‡å¯¼å…¥ç”¨æˆ·æ•°æ®

**ä½¿ç”¨æ–¹æ³•**:
```bash
node scripts/seed_users.js
```

---

## ğŸ“Š ä¾èµ–ç®¡ç†

### package.json
**ä¸»è¦ä¾èµ–**:

**è¿è¡Œæ—¶ä¾èµ–**:
```json
{
  "express": "^4.18.2",
  "mysql2": "^3.6.0",
  "bcrypt": "^5.1.1",
  "express-session": "^1.17.3",
  "helmet": "^7.1.0",
  "express-rate-limit": "^7.1.5",
  "cors": "^2.8.5",
  "xlsx": "^0.18.5"
}
```

**å¼€å‘ä¾èµ–**:
```json
{
  "nodemon": "^3.0.1"
}
```

**è„šæœ¬å‘½ä»¤**:
```json
{
  "start": "node server.js",
  "dev": "nodemon server.js"
}
```

---

## ğŸ—‚ï¸ æ•°æ®æ¨¡å‹

### æ•°æ®åº“è¡¨å…³ç³»

```
users (ç”¨æˆ·è¡¨)
    â†“
calculation_history (è®¡ç®—å†å²)
    â†“
special_subsidies (ç‰¹æ®Šè¡¥åŠ©)

school_registry (å­¦æ ¡æ³¨å†Œè¡¨)
    â†“
planned_students (è§„åˆ’å­¦ç”Ÿæ•°)
    â†“
current_area_presets (ç°æœ‰é¢ç§¯é¢„è®¾)

basic_area_standards (åŸºç¡€æ ‡å‡†)
subsidized_area_standards (è¡¥è´´æ ‡å‡†)
```

### æ ¸å¿ƒå­—æ®µè¯´æ˜

#### calculation_history (77ä¸ªå­—æ®µ)
**å­¦ç”Ÿæ•°æ®** (8ä¸ªå­—æ®µ):
- fulltime_undergrad - å…¨æ—¥åˆ¶æœ¬ç§‘ç”Ÿ
- fulltime_specialist - å…¨æ—¥åˆ¶ä¸“ç§‘ç”Ÿ
- fulltime_master - å…¨æ—¥åˆ¶ç¡•å£«ç”Ÿ
- fulltime_doctor - å…¨æ—¥åˆ¶åšå£«ç”Ÿ
- international_undergrad - ç•™å­¦ç”Ÿæœ¬ç§‘
- international_specialist - ç•™å­¦ç”Ÿä¸“ç§‘
- international_master - ç•™å­¦ç”Ÿç¡•å£«
- international_doctor - ç•™å­¦ç”Ÿåšå£«

**é¢ç§¯æ•°æ®** (7ç§ç”¨æˆ¿ç±»å‹ Ã— 7ä¸ªç»´åº¦ = 49ä¸ªå­—æ®µ):

ç”¨æˆ¿ç±»å‹:
1. teaching - æ•™å­¦åŠè¾…åŠ©ç”¨æˆ¿
2. library - å›¾ä¹¦é¦†
3. sports - ä½“è‚²ç”¨æˆ¿
4. admin - è¡Œæ”¿åŠå…¬ç”¨æˆ¿
5. life - ç”Ÿæ´»ç¦åˆ©åŠå…¶ä»–ç”¨æˆ¿
6. special - ä¸“é¡¹
7. infrastructure - é™„å±ç”¨æˆ¿ï¼ˆåœ°ä¸‹è½¦åº“ç­‰ï¼‰

æ¯ç§ç”¨æˆ¿ç±»å‹çš„7ä¸ªç»´åº¦:
- current - ç°æœ‰é¢ç§¯
- preliminary - åˆæ­¥è§„åˆ’é¢ç§¯
- under_construction - åœ¨å»ºé¢ç§¯
- planned - è§„åˆ’é¢ç§¯
- total - æ±‡æ€»é¢ç§¯ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
- required - åº”é…é¢ç§¯ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
- gap - ç¼ºå£é¢ç§¯ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰

---

## ğŸ” å¸¸è§å¼€å‘ä»»åŠ¡

### æ·»åŠ æ–°å­¦æ ¡
1. ç›´æ¥åœ¨æ•°æ®åº“ä¸­æ·»åŠ ï¼š
   ```sql
   INSERT INTO school_registry (school_name, school_type) 
   VALUES ('æ–°å­¦æ ¡åç§°', 'é™¢æ ¡ç±»å‹');
   ```
2. ç³»ç»Ÿè‡ªåŠ¨ä»æ•°æ®åº“è¯»å–ï¼Œæ— éœ€ä¿®æ”¹ä»£ç 

### ä¿®æ”¹å­¦æ ¡ç±»å‹
1. æ•°æ®åº“æ›´æ–°ï¼š
   ```sql
   UPDATE school_registry 
   SET school_type = 'æ–°ç±»å‹' 
   WHERE school_name = 'å­¦æ ¡åç§°';
   ```
2. ç³»ç»Ÿé€šè¿‡ `getSchoolType()` è‡ªåŠ¨è·å–æœ€æ–°æ•°æ®

### æ·»åŠ æ–°çš„é™¢æ ¡ç±»å‹
1. åœ¨ `basic_area_standards` è¡¨ä¸­æ·»åŠ æ–°ç±»å‹çš„æ ‡å‡†
2. åœ¨ `subsidized_area_standards` è¡¨ä¸­æ·»åŠ æ–°ç±»å‹çš„è¡¥è´´æ ‡å‡†
3. ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½åˆ° `DYNAMIC_BASIC_STANDARDS` å’Œ `DYNAMIC_SUBSIDIZED_STANDARDS`

### ä¿®æ”¹é¢ç§¯æ ‡å‡†
1. æ–¹å¼ä¸€ï¼šé€šè¿‡ç®¡ç†å‘˜ç•Œé¢ï¼ˆæ¨èï¼‰
   - ç™»å½•â†’æ ‡å‡†ç®¡ç†â†’ä¿®æ”¹æ ‡å‡†å€¼

2. æ–¹å¼äºŒï¼šç›´æ¥ä¿®æ”¹æ•°æ®åº“
   ```sql
   UPDATE basic_area_standards 
   SET standard_value = æ–°å€¼ 
   WHERE school_type = 'é™¢æ ¡ç±»å‹' AND room_type = 'ç”¨æˆ¿ç±»å‹';
   ```

### è°ƒè¯•æ•°æ®æŒä¹…åŒ–é—®é¢˜
1. æ£€æŸ¥ `config/dataService.js` ä¸­çš„å­—æ®µæ˜ å°„
2. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—ä¸­çš„SQLè¯­å¥
3. éªŒè¯å‰ç«¯å‘é€çš„æ•°æ®æ ¼å¼
4. ç¡®è®¤æ•°æ®åº“è¡¨ç»“æ„å’Œå­—æ®µå

### æ·»åŠ æ–°çš„æ§åˆ¶å™¨å’Œè·¯ç”±
1. åˆ›å»ºæ§åˆ¶å™¨ï¼š`controllers/newFeature.controller.js`
2. åˆ›å»ºè·¯ç”±ï¼š`routes/newFeature.routes.js`
3. åœ¨ `config/routes.js` ä¸­æ³¨å†Œè·¯ç”±
4. åœ¨ `server.js` ä¸­å¯¼å…¥å¹¶ä½¿ç”¨

---

## ğŸš¨ å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1: æ•°æ®ä¿å­˜åæŸ¥è¯¢ä¸åˆ°
**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥æ§åˆ¶å°Networkæ ‡ç­¾ï¼Œç¡®è®¤APIå“åº”
2. æŸ¥çœ‹`logs/combined.log`ä¸­çš„æ•°æ®åº“æ“ä½œæ—¥å¿—
3. ç›´æ¥æŸ¥è¯¢æ•°æ®åº“ç¡®è®¤æ•°æ®æ˜¯å¦æ’å…¥æˆåŠŸ
4. éªŒè¯å­—æ®µåæ˜ å°„ï¼ˆå‚è€ƒdataService.jsï¼‰

### é—®é¢˜2: Excelå¯¼å‡ºæ˜¾ç¤º0å€¼
**æ’æŸ¥æ­¥éª¤**:
1. âœ… å·²ä¿®å¤ï¼ˆ2025å¹´1æœˆï¼‰
2. ç¡®è®¤ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ä»£ç 
3. éªŒè¯server.jsä¸­ä½¿ç”¨`*_total`å­—æ®µ
4. æŸ¥è¯¢æ•°æ®åº“ç¡®è®¤æ•°æ®å­˜åœ¨

### é—®é¢˜3: ä¸‹è½½æ“ä½œæŠ¥é”™
**æ’æŸ¥æ­¥éª¤**:
1. âœ… å·²ä¿®å¤ï¼ˆ2025å¹´1æœˆï¼‰
2. ç¡®è®¤ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬api.js
3. éªŒè¯apiDeleteå‡½æ•°æœ‰`data &&`æ£€æŸ¥
4. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### é—®é¢˜4: ç™»å½•é™æµè§¦å‘
**è§£å†³æ–¹æ³•**:
```bash
# é‡å¯æœåŠ¡å™¨æ¸…é™¤é™æµè®°å½•
pm2 restart school-area-system

# æˆ–ç­‰å¾… 15 åˆ†é’Ÿåé‡è¯•
```

### é—®é¢˜5: æµ‹è¯•å¤±è´¥
**æ’æŸ¥æ­¥éª¤**:
1. ç¡®è®¤æœåŠ¡å™¨è¿è¡Œä¸­ï¼ˆ`pm2 status`ï¼‰
2. æ£€æŸ¥æ•°æ®åº“è¿æ¥
3. é‡å¯æœåŠ¡å™¨æ¸…é™¤é™æµ
4. æŸ¥çœ‹æµ‹è¯•æ—¥å¿—è¯¦ç»†é”™è¯¯

---

## ğŸ“š æ‰©å±•èµ„æº

### å®˜æ–¹æ–‡æ¡£é“¾æ¥
- [Node.jsæ–‡æ¡£](https://nodejs.org/docs/)
- [Express.jsæ–‡æ¡£](https://expressjs.com/)
- [MySQLæ–‡æ¡£](https://dev.mysql.com/doc/)
- [BCryptæ–‡æ¡£](https://github.com/kelektiv/node.bcrypt.js)
- [XLSX.jsæ–‡æ¡£](https://docs.sheetjs.com/)
- [Helmetæ–‡æ¡£](https://helmetjs.github.io/)
- [express-rate-limitæ–‡æ¡£](https://github.com/express-rate-limit/express-rate-limit)

### å­¦ä¹ èµ„æº
- RESTful APIè®¾è®¡æœ€ä½³å®è·µ
- Node.jså®‰å…¨ç¼–ç¨‹æŒ‡å—
- MySQLæ€§èƒ½ä¼˜åŒ–æŒ‡å—
- å‰ç«¯æ¨¡å—åŒ–æ¶æ„è®¾è®¡

---

<div align="center">

**æœ¬æ–‡æ¡£æœ€åæ›´æ–°**: 2025å¹´10æœˆ24æ—¥  
**é¡¹ç›®ç‰ˆæœ¬**: v2.3.0 ğŸ‰  
**æ¶æ„**: MVCæ¨¡å¼ + æ·±åº¦æ¨¡å—åŒ–è®¾è®¡

---

## ğŸ“ˆ ç‰ˆæœ¬å†å²

### v2.3.0 (2025-10-24) ğŸ‰ NEW
**æ¨¡å—åŒ–æ¶æ„æ·±åº¦ä¼˜åŒ–**

**server.jsä¸¤é˜¶æ®µä¼˜åŒ–**ï¼š
- ç¬¬ä¸€é˜¶æ®µï¼ˆMVCé‡æ„ï¼‰ï¼š2,001è¡Œ â†’ 362è¡Œ (-81.9%)
- ç¬¬äºŒé˜¶æ®µï¼ˆæ·±åº¦æ¨¡å—åŒ–ï¼‰ï¼š362è¡Œ â†’ **212è¡Œ** (-41.4%)
- **æ€»ä½“ä¼˜åŒ–ï¼š2,001è¡Œ â†’ 212è¡Œ (-89.4%)**

**æ–°å¢7ä¸ªæ¨¡å—æ–‡ä»¶**ï¼š
1. `config/utils/helpers.js` (120è¡Œ) - é€šç”¨å·¥å…·å‡½æ•°
   - formatAreaToTwoDecimals, cleanSchoolType
   - cleanupOldFiles, startCleanupSchedule

2. `config/utils/calculator.js` (280è¡Œ) - è®¡ç®—å¼•æ“æ ¸å¿ƒ
   - getSchoolType, loadCalculationStandards
   - calculateBuildingAreaGap (196è¡Œæ ¸å¿ƒé€»è¾‘)

3. `config/utils/excelGenerator.js` (330è¡Œ) - Excelç”Ÿæˆå™¨
   - generateFormattedResultSheet (311è¡Œæ ¼å¼åŒ–é€»è¾‘)

4. `config/controllers/online.controller.js` (650è¡Œ) - åœ¨çº¿è®¡ç®—æ§åˆ¶å™¨
   - onlineCalculate, onlineDownload
   - downloadCalculationResults

5. `config/routes/online.routes.js` (60è¡Œ) - åœ¨çº¿è·¯ç”±å®šä¹‰
   - 3ä¸ªè·¯ç”± + é™æµé…ç½®

6. `middleware/security.middleware.js` (159è¡Œ) - å®‰å…¨ä¸­é—´ä»¶
   - SSLé…ç½®ã€Helmetã€ä¼šè¯ç®¡ç†ã€URLå®‰å…¨éªŒè¯

7. `middleware/static.middleware.js` (88è¡Œ) - é™æ€æ–‡ä»¶ä¸­é—´ä»¶
   - é™æ€æ–‡ä»¶é…ç½®ã€é¡µé¢è·¯ç”±é‡å®šå‘

**æ¶æ„ä¼˜åŒ–æˆæœ**ï¼š
- âœ… 9ä¸ªæ§åˆ¶å™¨ + 9ä¸ªè·¯ç”±æ¨¡å—
- âœ… 3ä¸ªå·¥å…·æ¨¡å—ï¼ˆhelpers, calculator, excelGeneratorï¼‰
- âœ… 4ä¸ªä¸­é—´ä»¶ï¼ˆauth, rateLimiter, security, staticï¼‰
- âœ… server.jsèŒè´£å•ä¸€åŒ–ï¼šä»…è´Ÿè´£ç»„è£…å’Œå¯åŠ¨
- âœ… ä»£ç å¯ç»´æŠ¤æ€§å¤§å¹…æå‡
- âœ… æµ‹è¯•é€šè¿‡ï¼šæ‰€æœ‰åŠŸèƒ½éªŒè¯æ­£å¸¸

### v2.2.0 (2025-10-24)
- âœ… MVCæ¶æ„é‡æ„å®Œæˆ
- âœ… server.js ä» 5,465 è¡Œç²¾ç®€åˆ° 2,001 è¡Œï¼ˆ-64%ï¼‰
- âœ… 8ä¸ªæ§åˆ¶å™¨ + 8ä¸ªè·¯ç”±æ¨¡å—åŒ–
- âœ… ç§»é™¤ç¡¬ç¼–ç å­¦æ ¡ç±»å‹æ˜ å°„
- âœ… å­¦æ ¡ç±»å‹æ”¹ä¸ºæ•°æ®åº“åŠ¨æ€æŸ¥è¯¢
- âœ… é™æµç­–ç•¥è°ƒæ•´ä¸º 4x
- âœ… å¤‡ä»½æ–‡ä»¶æ•´ç†å®Œæˆ

### v2.1.1 (2025-10-23)
- âœ… å®Œæ•´å®‰å…¨æµ‹è¯•å¥—ä»¶
- âœ… Helmet 7+ å®‰å…¨å¤´
- âœ… 5çº§é™æµç­–ç•¥
- âœ… æµ‹è¯•æ–‡æ¡£å®Œå–„

### v2.1.0 (2025-09-18)
- âœ… å‰ç«¯æ¨¡å—åŒ–é‡æ„
- âœ… 9ä¸ªç‹¬ç«‹CSSæ¨¡å—
- âœ… 14ä¸ªJavaScriptæ¨¡å—
- âœ… ç»„ä»¶åŒ–è®¾è®¡

</div>
